# fly.toml app configuration file generated for edgi-cloud on 2025-08-04T11:56:19-04:00
#
# See https://fly.io/docs/reference/configuration/ for information about how to use this file.
#

app = 'edgi-cloud'
primary_region = 'ord'

[build]

[env]
RESETTE_DATA_DIR = '/data'
RESETTE_STATIC_DIR = '/app/static'
PORTAL_DB_PATH = '/data/portal.db'
APP_URL = 'https://edgi-cloud.fly.dev'
# Configure Uvicorn to trust proxy headers for real client IPs
# FORWARDED_ALLOW_IPS = '*'
# Alternative: specify Fly.io's proxy network
FORWARDED_ALLOW_IPS = '172.16.0.0/12'

[[mounts]]
source = 'edgi_data_volume'
destination = '/data'

[http_service]
internal_port = 8001
force_https = true
auto_stop_machines = 'off'
auto_start_machines = false
min_machines_running = 1
processes = ['app']
[http_service.concurrency]
type = "requests"
soft_limit = 20
hard_limit = 25
